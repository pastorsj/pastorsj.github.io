<div>
  <h2 class="text-primary"> Deploying a website on an EC2 instance in AWS </h3>
  <h5 class="text-muted"> By Sam Pastoriza on July 27, 2016 </h5>
  <p>
    Today, I successfully deployed my first website on public domain, which happened to 
    be my personal website. This is also my first blog post because I have also finally gotten around to 
    making a blog documenting my experiences in the programming world. I hope you enjoy these articles as 
    I enjoy experiencing them. Now, lets get to the important stuff.
  </p>
  <p>
    I am going to discuss how to launch a NodeJS application, specifically written with the Angular 2 framework on the front end
    and the Express framework on the backend. This post applies to anyone who wants to deploy a Node application on an Linux box
    and redirect a chosen Domain name to that server.
  </p>

  <ol>
    <li>Create a AWS Account if you have not already</li>
    <li>
      Create a Key Pair.
      <ul>
        <li>This is a very straightforward process well documented by Amazon Web Services. This key-pair will be used to ssh into the linux box, so it is important that you keep the key in a secure place.</li>
        <li>Documentation on process can be found <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html"></li>
        <li>Make sure to run <code>chmod 400 <your-key>.pem</code></li>
      </ul>
    </li>
    <li>Go to the [AWS Managment Console](https://console.aws.amazon.com/console/home?region=us-east-1)</li>
    <li>Choose to run a EC2 instance</li>
    <li>Click <strong>Launch Instance</strong></li>
    <li>
      Once you click <strong>Launch Instance</strong>, choose <strong>Amazon Linux</strong>.
      <ul>
        <li>This is a general purpose empty Linux box that AWS supports.</li>
      </ul>
    </li>
    <li>Once you select the Ubuntu box, choose the t2.micro option, which is 8Gb, plenty for deploying general purpose Node applications</li>
    <li>Click next until you reach the <strong>Configure Security Group</strong> tab. </li>
    <li>On the <strong>Configure Security Group</strong> tab, make sure to add a rule and change the rule from <strong>Custom TCP Rule</strong> to <strong>HTTP</strong>. This should default the Port number to 80.</li>
    <li>Before launching the instance, make sure you associate the Key Pair you created with the EC2 instance.</li>
    <li>Once the instance has been launched, go ahead and ssh into the instance using your generated key pair.</li>
    <li>
      Run the following commands to update your Linux box and install NodeJS and Git. <br>
      <code>
        sudo yum update <br>
        sudo yum install git <br>
        wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.31.1/install.sh | bash <br>
        source ~/.profile <br>
        . ~/.nvm/nvm.sh <br>
        nvm install 5.11.0 <br>
        modprobe ip_tables <br>
        iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to 3000 <br>
        echo "source ~/.bashrc" >> ~/.bash_profile <br>
        echo 'export NVM_DIR="$HOME/.nvm' >> ~/.bashrc <br>
        echo '[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh' >> ~/.bashrc <br>
      </code>
      <p>
        At this point, you should have the following installed
        <ul>
          <li>Git</li>
          <li>NodeJS</li>
          <li>NVM (Node Version Manager)</li>
          <li>NPM</li>
        </ul>
        <p>
          The first two lines update and install pacakages on the server. Lines 2-6 install Node using nvm. Lines 7-8 are `very` important because they redirect
          any http requests to port 3000. Port 80 is the default port, but Express applications cannot listen to port 80. Feel free to change this number as your application
          sees fit.
        </p>
    </li>
    <li>
      Once the essential items are installed for running a node application, you can either
      <ol>
        <li>Clone an existing project and start running it</li>
        <li>
          Using <strong>express-generator</strong>, create an simple express application
          <div>
            Run this set of commands to create an express application <br>
            <code>
              npm install -g express-generator <br>
              express your-application <br>
              cd your-application <br>
              npm install <br>
              npm start <br>
            </code>
            Hopefully, you will see that the application is listening to a port, most likely 3000
          </div>
        </li>
      </ol>
    </li>
    <li>If you navigate to your `Public DNS` in your browser, you should see your application displayed.</li>
  </ol>

  <h3 class="text-primary">Connecting your application to a Public URL using Amazon's Route 53 service</h3>
  <div>
    Amazon has made it very easy to test and create public url's for $12 a year. You are welcome to get a url on another site, but make sure that you associate that url with the Elastic IP address created in Step #__
  </div>
  <div>
    More to come...
  </div>
  <div>
    <h3 class="text-primary">Cited Sources</h3>
    <a class="label label-info" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EC2_GetStarted.html">AWS Documentation</a>
    <a class="label label-info" href="https://codeforgeek.com/2015/05/setup-node-development-environment-amazon-ec2/">Code for Geek</a>
    <a class="label label-info" href="http://www.bennadel.com/blog/2321-how-i-got-node-js-running-on-a-linux-micro-instance-using-amazon-ec2.htm">Ben Nadal</a>
  </div>
</div>